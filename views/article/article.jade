extends ../layout.jade

block vars
  - var title = article.title + ' - Wang Shenwei'
  - var nav = 'article'
  - var scripts = ['http://weihub.com/js/article.js']

block unsigned


block content
  .container
    .row
      .col-md-8.col-md-offset-2
        .article-container
          h1.article-title= article.title
          p.article-meta.text-muted
            = article.str_create_time
            - var tags = article.tags && article.tags.split(',')
            if tags
              each tag in tags
                | &nbsp;
                a.text-muted= '#' + tag
            if user && user.admin
              | &nbsp;
              a.btn.btn-xs.btn-default(href='/article/' + article.uri + '/edit')
                span.glyphicon.glyphicon-edit
                |  编辑
          .article-content!= article.html
        hr
        #comments.comment-container
          div
            strong 评论 
            span#comment-loading.text-muted (加载中)
            span#comment-badge.badge.hidden 6
          hr
          .media(style='margin-bottom:15px')
            .pull-left.media-profile
              if user && user.avatar
                img(src=user.avatar, width='64', height='64')
              else
                span.glyphicon.glyphicon-user.text-muted
            .media-body
              div.has-feedback
                textarea#comment-text.form-control(style='height:64px;margin-bottom:10px;resize:vertical',placeholder='加入讨论')
              #comment-btns.comment-btns.hidden(class=user ? 'comment-btns-signed' : '')
                if ! user
                  .col-auth
                    p.text-muted 使用社交账号登录：
                    div
                      - var path = '/article/' + article.uri + '#comments'
                      a.btn-auth.btn-auth-weibo(href='/auth/redirect/weibo?path=' + path, title='微博')
                        span.sr-only 微博
                      a.btn-auth.btn-auth-qq(href='/auth/redirect/qq?path=' + path, title='QQ')
                        span.sr-only QQ
                      a.btn-auth.btn-auth-github(href='/auth/redirect/github?path=' + path, title='GitHub')
                        span.sr-only GitHub
                      a.btn-auth.btn-auth-instagram(href='/auth/redirect/instagram?path=' + path, title='Instagram')
                        span.sr-only Instagram
                  .col-name
                    p.text-muted 或者输入一个名字：
                    div.has-feedback
                      input#comment-user.form-control
                .col-submit
                  p.text-muted &nbsp;
                  button#comment-submit.btn.btn-primary(type='submit')
                    |  &nbsp; 
                    span.glyphicon.glyphicon-arrow-right
                    |  &nbsp;
          ul#comment-list.media-list.comment-list
        script#tpl-comment(type='text/template')
          include comment.tpl
